# 第02节：模板字符串与函数



### 二、函数

在ES2015中扩展了很多函数的功能，我们在本节讲解两个最常用的功能：

* 设置函数参数默认值
* 箭头函数

**参数默认值**

在ES2015版本之前，我们可以通过下面的方法设置函数参数的默认值
代码如下所示:

``` js
//es5设置默认值
function fun1(x,y){
    x = x || 100;
    y = y || 200;
    return x + y;
}
```

如果逻辑或运算符的左侧是undefined，那么表达式的值就是右侧的值，如果左侧不是undefined，那么表达式的值就是左侧的值，我们可以通过这种方法设置函数参数的默认值，但是这种方法看上去并不是那么友好，所以ES2015为函数增加了设置默认值的功能
代码如下所示:

``` js
//es2015+设置默认值
function fun2(x=100,y=200){
    return x + y;
}
```

这样设置默认值更加直观，让代码更加容易让人理解。

**箭头函数**

在ES2015中增加了箭头函数的语法，我们可以使用=>来定义函数，而不必每次都要写一个function
具体写法如下所示:

``` js
var fun = x=>x*x;
console.log(fun(6));
```

箭头的前面是函数的参数，箭头的后面是函数的返回值，程序运行后会在控制台输出36。

如果函数没有参数(没有参数时用小括号来表示)，并且函数体不止一行代码，可以用如下的代码表示:

``` js
let fun = ()=>{
    let x = 10;
    let y = 20;
    return x + y;
}
console.log(fun());
```
如上面的代码所示，箭头的左侧我们添加一个小括号，箭头的右侧用一个花括号表示一个代码块。如果程序有多个参数，我们同样可以将多个参数写在箭头右侧的中括号中。

**箭头函数进阶**

箭头函数不仅简化了函数的写法，让函数中的this指针变得更人性化。我们来看下面的例子[demo01.html](https://github.com/xiaozhoulee/xiaozhou-examples/blob/master/04-ES2015%2B/%E7%AC%AC02%E8%8A%82%EF%BC%9AES2015%EF%BC%88%E4%BA%8C%EF%BC%89/demo01.html)

``` js
const person = {
    firstName:"lee",
    sing:function(){
        console.log(this.firstName)
    },
    singDelay:function(){
        setTimeout(function(){
            console.log(this.firstName);
        },2000)
    }
}

person.sing();
person.singDelay();
```

在上面的代码中，我们可以看到第一个输出的名字是lee，第二个输出的名字是undefined。因为setTimeout参数中定义的函数是window对象调用的，setTimeout参数中的回调函数里面的this指向的是window对象，所示this.firstName的值是undefined。如果希望上面的代码能正常输出两个lee，
可以如下所示:[demo02.html](https://github.com/xiaozhoulee/xiaozhou-examples/blob/master/04-ES2015%2B/%E7%AC%AC02%E8%8A%82%EF%BC%9AES2015%EF%BC%88%E4%BA%8C%EF%BC%89/demo02.html)

``` js
const person = {
    firstName: "lee",
    sing: function () {
        console.log(this.firstName)
    },
    singDelay: function () {
        let self = this
        setTimeout(function () {
            console.log(self.firstName);
        }, 2000)
    }
}

person.sing();
person.singDelay();
```

在上面的代码中，我们定义了一个变量self用来存储指向person的this，这样我们就可以正确地输出lee。但是这样的写法看起来有给我们增加了一些复杂度，我们可以用箭头函数来解决这个问题，
代码如下所示[demo03.html](https://github.com/xiaozhoulee/xiaozhou-examples/blob/master/04-ES2015%2B/%E7%AC%AC02%E8%8A%82%EF%BC%9AES2015%EF%BC%88%E4%BA%8C%EF%BC%89/demo03.html)

``` js
const person = {
    firstName: "lee",
    sing: function () {
        console.log(this.firstName)
    },
    singDelay: function () {
        setTimeout(() => {
            console.log(this.firstName);
        }, 2000)
    }
}

person.sing();
person.singDelay();
```

在上面的代码中，成功地输出了两个lee，这是因为箭头函数中的this，不是调用函数时的this指向的对象，而是定义函数时this指向的对象，定义函数的时候，this指向的是person而不是window，所以这里可以正确地输出结果。








